[CONEXION]
Montoya0823
800028761-0

|dbparm = ConnectString='DSN=ps_sai_pltelas_local;UID=postgres;PWD=admin',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_sai_plasbenit_local;UID=postgres;PWD=admin',CommitOnDisconnect='No'

|dbparm = ConnectString='DSN=ps_pltelas;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_plasbenit;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'

|dbparm = ConnectString='DSN=ps_pltelas_jupiter;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_plasbenit_hamachi;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'
dbparm = ConnectString='DSN=ps_pltelas_hamachi;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_decorespumas;UID=postgres;PWD=admin',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_colchones;UID=postgres;PWD=admin',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_puntocentro;UID=postgres;PWD=admin',CommitOnDisconnect='No'

app = 'SI-ERP'
desc_app = 'Sistema Administrativo Integrado'a
logo  = 'SI'

|dbparm = ConnectString='DSN=;UID=postgres;PWD=admin',CommitOnDisconnect='No'

|dbparm = ConnectString='DSN=sai_locogas;UID=DBA;PWD=SQL',CommitOnDisconnect='No'

|dbparm = ConnectString='DSN=ps_pos_ovidio;UID=postgres;PWD=admin',CommitOconnect='No'
|app = 'POS'
|desc_app = ''
|logo  = 'NO'ps_plasbenit

|dbparm = ConnectString='DSN=SAI_SI_LOCAL;UID=postgres;PWD=gco',CommitOnDisconnect='No'
|app = 'SI-POS'
|desc_app = 'Soluciones Informáticas POS'
|logo  = 'NO'


[OTRO ALMACEN]
|dbparm = ConnectString='DSN=ps_pltelas_hamachi;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_pltelas_jupiter;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_pltelas;UID=postgres;PWD=admin',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_plasbenit;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'
|dbparm = ConnectString='DSN=ps_sai_plasbenit_local;UID=postgres;PWD=admin',CommitOnDisconnect='No'
dbparm = ConnectString='DSN=ps_plasbenit_hamachi;UID=postgres;PWD=pltelas',CommitOnDisconnect='No'

app = 'SAI'
desc_app = 'Sistema Administrativo Integrado'
logo  = 'SI'








/////////////////////////////////////////////ACTUALIZAR DISEÑO Y COLOR///////////////////////////////
//  SELECT * FROM plt_referencia  
//   WHERE ref_cantidad <> 0   
//and ref_estado = 'inactivo';

// UPDATE plt_referencia  SET ref_cantidad = 0
//   WHERE ref_cantidad <> 0   
//and ref_estado = 'inactivo';

INSERT INTO plt_proveedor(
            pro_proveedor, pro_nombre, pro_nit, pro_fecha, pro_estado, pro_iva, 
            pro_plazo, pro_retenedor, pro_telefono, pro_direccion, pro_email, 
            ciu_ciudad, pro_porcdscto, pro_porciva, pro_grancont, reg_regimen, 
            pro_gasto)
    VALUES (0;"SIN PROVEEDOR";"0";"2013-01-10";"activo";"S";0;"S";"0";"X";"X";7;0.00;16.00;"S";1;"");
            
//  SELECT * FROM plt_referencia  
//   WHERE plt_referencia.pro_proveedor is NULL   ;

//UPDATE plt_referencia  SET pro_proveedor = 0
//   WHERE plt_referencia.pro_proveedor is NULL   ;


//  SELECT *  FROM plt_referencia  
//   WHERE ref_color = ''   ;

//UPDATE  plt_referencia  SET ref_color = 0
//   WHERE ref_color = ''   ;

//  SELECT *  FROM plt_referencia  
//   WHERE TRIM(ref_color) = ''  
//and ref_estado = 'activo'  ;

//UPDATE  plt_referencia  SET ref_color = 0
//   WHERE TRIM(ref_color) = ''   
//and ref_estado = 'activo'  ;


//  SELECT *  FROM plt_referencia  
//   WHERE ref_diseno = ''  ;

//UPDATE  plt_referencia  SET ref_diseno = 0
//   WHERE ref_diseno = ''   ;

//  SELECT *  FROM plt_referencia  
//   WHERE TRIM(ref_diseno) = ''  
//and ref_estado = 'activo'  ;

//UPDATE  plt_referencia  SET ref_color = 0
//   WHERE TRIM(ref_diseno) = ''   
//and ref_estado = 'activo'  ;

//  SELECT *  FROM plt_movinv  
//   WHERE ( plt_movinv.min_color = '' ) AND  
//         ( plt_movinv.min_fcaja >= '2012/12/01' )   ;
//
//UPDATE plt_movinv  SET min_color = 0
//   WHERE ( min_color = '' ) AND  
//         ( min_fcaja >= '2012/12/01' )   ;

//  SELECT *  FROM plt_movinv  
//   WHERE ( plt_movinv.min_diseno = '' ) AND  
//         ( plt_movinv.min_fcaja >= '2012/12/01' )   ;
//
//UPDATE plt_movinv  SET min_diseno = 0
//   WHERE ( min_diseno = '' ) AND  
//         ( min_fcaja >= '2012/12/01' )   ;

//  SELECT *  FROM plt_movinv  
//   WHERE ( trim(plt_movinv.min_color) = '' ) AND  
//         ( plt_movinv.min_fcaja >= '2012/12/01' )   ;

//UPDATE plt_movinv  SET min_color = 0
//   WHERE ( trim(plt_movinv.min_color) = '' ) AND  
//         ( plt_movinv.min_fcaja >= '2012/12/01' )   ;

//  SELECT *  FROM plt_movinv  
//   WHERE ( trim(plt_movinv.min_diseno) = '' ) AND  
//         ( plt_movinv.min_fcaja >= '2012/12/01' )   ;

//UPDATE plt_movinv  SET min_diseno = 0
//   WHERE ( trim(plt_movinv.min_diseno) = '' ) AND  
//         ( plt_movinv.min_fcaja >= '2012/12/01' )   ;



PENDIENTES SABADO 13/ABRIL/2012

Replantear la tirilla de cierre de caja
Arreglar los medios de pago
adionar devueltas
y gran total
los abonos  se deben discriminar por pedido o por cobro

Revisar la tirilla de los abonos que no salga la palabra Factura de venta,sino Abono, y tampoco
resoluciones, ni terminos como SOMOS AUTORRETENEDORES Y REGIMEN entre otros

Informe de planilla mostrarlo agrupado o detallado(ya está detallado)
en este debe quitar pagos a proveedores, pago a retefuente, pago reteiva, pago iva bimestral, compra sincha
el concepto seguridad social si está bueno y tambien lo ingresa en la planilla de otros gastos, esta opcion la
dejamos un mes mas y luego la desactivamos
no deben sumar a los gastos, pero si mostrar el resumen al final(informativo)
el informe no valida la empresa, trae lo mismo sin importar la empresa seleccionada

Cargar los planos automáticamente

//REPORTE DE PRODUCTOS ADICIONAR CAMPO CON PROMEDIO DE VENTAS MENSUAL EN LOS ULTIMOS 6 MESES

INFORME DE RECAUDOS POR CLIENTE EN LOS CRITERIOS ADICIONAR EL VENDEDOR
EN EL INFORME DE FACTURACIÓN POR PRODUCTO ADICIONAR COMO CRITERIO EL VENDEDOR
EN EL INFORME DE GASTOS REVISAR PORQUE SALEN UNOS EN CERO. ARREGLARLO PARA QUE SALGA IGUAL QUE LAS COMPRAS CON TODOS
LOS CONCEPTOS TRIBUTARIOS
		 
////revisa compras
		   SELECT plt_saldoprov.*
    FROM public.plt_detrecprov,   
         public.plt_reciboprov,   
         public.plt_saldoprov  
   WHERE ( public.plt_detrecprov.rep_reciboprov = public.plt_reciboprov.rep_reciboprov ) and  
         ( public.plt_reciboprov.pro_proveedor = public.plt_saldoprov.pro_proveedor ) and  
         ( public.plt_saldoprov.emp_empresa = public.plt_reciboprov.emp_empresa ) and  
         ( public.plt_saldoprov.tdc_dcmto = public.plt_detrecprov.tdc_dcmto ) and  
         ( public.plt_saldoprov.slp_dcmto = public.plt_detrecprov.drp_dcmto ) and  
         ( public.plt_saldoprov.emp_empresa = public.plt_detrecprov.emp_empresa ) and  
         ( ( public.plt_detrecprov.emp_empresa = 1 ) AND  
         ( public.plt_saldoprov.slp_saldo <> 0 ) AND  
         ( public.plt_saldoprov.slp_estado <> 'anulado' ) )   ;
		 

En remisión no permitir ingresar el mismo número en el mismo proveedor
En la caja en los gastos que obligue dirección y telefono del proveedor

Cierre mensual


///////////////////////////////////////////////////////ACTUALIZAR////////////////////////////777
update sai_actualizapc set apc_actualiza = 'N' 
			where apc_actualiza = 'S' ;
////////////////////////////////////////////////////////////////////////////////////////////////////////7777


///////////////////////////////////////////////////////QUERYS ANULAR FACTURA////////////////////////////777
//  SELECT *
//    FROM public.plt_factura  
//   WHERE ( public.plt_factura.emp_empresa = 3 ) AND  
//         ( public.plt_factura.fac_factura in ('102129', '102215')  )   
//and tdc_tipodoc = 1
//and fac_fechaini >= '2016/01/01';

//  SELECT *
//    FROM public.plt_movcar  
//   WHERE ( public.plt_movcar.emp_empresa = 3 ) AND  
//         ( public.plt_movcar.mca_dcmto in ('102129', '102215')   ) 
//and tdc_dcmto = 1  
//and mca_fecha >= '2016/01/01';

//  SELECT *
//    FROM public.plt_saldo  
//   WHERE ( public.plt_saldo.emp_empresa = 3 ) AND  
//         ( public.plt_saldo.tdc_dcmto = 1 ) AND  
//         ( public.plt_saldo.sld_dcmto in ('102129', '102215')  ) 
//and sld_fechaini   >= '2016/01/01';

//  SELECT *
//    FROM public.plt_movinv  
//   WHERE ( public.plt_movinv.emp_empresa = 3 ) AND  
//         ( public.plt_movinv.min_dcmto in ('102129', '102215')   ) AND  
//         ( public.plt_movinv.tdc_dcmto = 1 ) 
//and min_fecha  >= '2016/01/01';

//  SELECT *
//    FROM public.plt_referencia  
//   WHERE public.plt_referencia.ref_referencia = '000317'  
////and ref_diseno = '0'
//and ref_color = '1556' ;

/////////////////////////////////////////////////////////////////////////////////////////////
@*8XS9?=RrskFE3A
10.2.166.157


y25q6r
///////////////////////////////////////////////////////QUERYS ANULAR ABONO EN CAJA////////////////////////////
//  SELECT *
//    FROM public.plt_factura  
//   WHERE ( public.plt_factura.emp_empresa = 3  ) AND  
//         ( public.plt_factura.fac_factura in ('25583')  )   
//and tdc_tipodoc = 11
//and fac_fechaini >= '2016/01/01';

//  SELECT *
//    FROM public.plt_movcar  
//   WHERE ( public.plt_movcar.emp_empresa = 3 ) AND  
//         ( public.plt_movcar.mca_dcmto in ('73668')  ) 
//and tdc_dcmto = 11  
//and mca_fecha >= '2016/01/01';

//  SELECT *
//    FROM public.plt_pago  
//   WHERE ( public.plt_pago.emp_empresa = 3 ) AND  
//         ( public.plt_pago.tdc_dcmto = 11 ) AND  
//         ( public.plt_pago.pag_dcmto = 73668 )   ;

/////////////////////////////////////////////////////////////////////////////////////////////



///////////////////////////////////////////////////////QUERYS ANULAR RECIBO DE CARTERA////////////////////////////
//  SELECT *
//    FROM public.plt_recibo  
//   WHERE ( public.plt_recibo.emp_empresa = 3 ) AND  
//         ( public.plt_recibo.rec_recibo = 25583 )   ;

//  SELECT *
//    FROM public.plt_detrecibo  
//   WHERE ( public.plt_detrecibo.emp_empresa = 3 ) AND  
//         ( public.plt_detrecibo.rec_recibo = 25583 )   ;


//  SELECT *
//    FROM public.plt_pago  
//   WHERE ( public.plt_pago.emp_empresa = 3 ) AND  
//         ( public.plt_pago.tdc_dcmto = 9 ) AND  
//         ( public.plt_pago.pag_dcmto = 25583 )   ;

//  SELECT *
//    FROM public.plt_saldo  
//   WHERE ( public.plt_saldo.emp_empresa = 3 ) AND  
//         ( public.plt_saldo.tdc_dcmto = 1 ) AND  
//         ( public.plt_saldo.sld_dcmto in ('84698') )   ;

/////////////////////////////////////////////////////////////////////////////////////////////


//////////////////////////////REVISIÓN DE REFERENCIA DESDE EL ULTIMO INVENTARIO

/  SELECT *
//    FROM public.plt_referencia  
//   WHERE ( public.plt_referencia.ref_nombre like '%NEGRO%' ) AND  
//         ( public.plt_referencia.ref_referencia = '000211' )   ;

//  SELECT *
//    FROM public.plt_inventariofin  
//   WHERE ( public.plt_inventariofin.emp_empresa = 3 ) AND  
//         ( public.plt_inventariofin.ivf_inventario = 4 ) AND  
//         ( public.plt_inventariofin.ref_referencia = '000211' ) AND  
//         ( public.plt_inventariofin.ref_color = 'NEGRO' )   ;
//

//  SELECT cpi_concepto
//    FROM public.plt_movinv  
//   WHERE ( public.plt_movinv.ref_referencia = '000211' ) AND  
//         ( public.plt_movinv.min_fecha >= '2015/01/25' ) AND  
//         ( public.plt_movinv.min_color = 'NEGRO' ) 
//AND min_estado = 'activo' 
//group by 1 ;

//  SELECT public.plt_cptoinv.cpi_concepto,   
//         public.plt_cptoinv.cpi_nombre,   
//         public.plt_cptoinv.cpi_dbcr  
//    FROM public.plt_cptoinv  
//   WHERE public.plt_cptoinv.cpi_concepto in ('1','3','4','51','54','63')   ;

//  SELECT cpi_concepto, sum(min_cantidad)
//    FROM public.plt_movinv  
//   WHERE ( public.plt_movinv.ref_referencia = '000211' ) AND  
//         ( public.plt_movinv.min_fecha >= '2015/01/25' ) AND  
//         ( public.plt_movinv.min_color = 'NEGRO' ) 
//AND min_estado = 'activo' 
//group by 1 ;

//54		689.85
//51		6036.00
//3			374.90
//4			391.40
//63		1.20
//1			6248.80


//  SELECT *
//    FROM public.plt_movinv  
//   WHERE ( public.plt_movinv.ref_referencia = '000211' ) AND  
//         ( public.plt_movinv.min_fecha >= '2015/01/25' ) AND  
//         ( public.plt_movinv.min_color = 'NEGRO' ) 
//AND min_estado = 'activo' ;

//  SELECT public.plt_movinv.ref_referencia,   
//         public.plt_movinv.min_color,   
//         public.plt_movinv.tdc_dcmto,   
//         public.plt_movinv.min_cantidad,   
//         public.plt_cptoinv.cpi_nombre,   
//         public.plt_movinv.min_dcmto,   
//         public.plt_movinv.min_fecha  
//    FROM public.plt_movinv,   
//         public.plt_cptoinv,   
//         public.plt_tipodoc  
//   WHERE ( public.plt_movinv.cpi_concepto = public.plt_cptoinv.cpi_concepto ) and  
//         ( public.plt_movinv.emp_empresa = public.plt_tipodoc.emp_empresa ) and  
//         ( public.plt_movinv.tdc_dcmto = public.plt_tipodoc.tdc_tipodoc ) and  
//         ( public.plt_movinv.caj_caja = public.plt_tipodoc.caj_caja ) and  
//         ( ( public.plt_movinv.ref_referencia = '000211' ) AND  
//         ( public.plt_movinv.min_color = 'NEGRO' ) AND  
//         ( public.plt_movinv.min_estado = 'activo' ) AND  
//         ( public.plt_movinv.min_fecha >= '2015/01/25' ) )   
//ORDER BY public.plt_movinv.min_fecha ASC  ;

//  SELECT public.plt_movinv.ref_referencia,   
//         public.plt_movinv.min_color,  
//         public.plt_movinv.min_cantidad,   
//         public.plt_cptoinv.cpi_nombre,   
//         public.plt_movinv.min_dcmto,   
//         public.plt_movinv.min_fecha  
//    FROM public.plt_movinv,   
//         public.plt_cptoinv
//   WHERE ( public.plt_movinv.cpi_concepto = public.plt_cptoinv.cpi_concepto ) and  
//               ( ( public.plt_movinv.ref_referencia = '000211' ) AND  
//         ( public.plt_movinv.min_color = 'NEGRO' ) AND  
//         ( public.plt_movinv.min_estado = 'activo' ) AND  
//         ( public.plt_movinv.min_fecha >= '2015/01/25' ) )   
//ORDER BY public.plt_movinv.min_fecha ASC  ;

//////////////////////////////////////////////////////////////////////////////////////////77777


////////////////////////////QUERYS PARA ARREGLAR CAJA PERDIDA//////////////////////////////7777

//  SELECT *
//    FROM public.plt_movcar  
//   WHERE ( public.plt_movcar.emp_empresa = 1 ) AND  
//         ( public.plt_movcar.mca_fecha = '2016/10/31' ) AND  
//         ( public.plt_movcar.caj_caja = 3 ) 
//and mca_estado = 'activo'  
//order by mca_dcmto;

//356970
//357009

//  SELECT *
//    FROM public.plt_factura  
//   WHERE ( public.plt_factura.emp_empresa = 1 ) AND  
//         ( public.plt_factura.fac_fechaini = '2016/10/31' ) AND  
//         ( public.plt_factura.caj_caja = 3 )
//and fac_estado = 'activo'  
//order by fac_factura ;

//  SELECT *
//    FROM public.plt_saldo  
//   WHERE ( public.plt_saldo.emp_empresa = 1 ) AND  
//         ( public.plt_saldo.sld_fechaini = '2016/10/29' ) AND  
//         ( public.plt_saldo.caj_caja = 3 ) AND  
//         ( public.plt_saldo.sld_estado = 'activo' )   
//ORDER BY public.plt_saldo.sld_dcmto ASC  ;

//  SELECT *
//    FROM public.plt_pago  
//   WHERE ( public.plt_pago.emp_empresa = 1 ) AND  
//         ( public.plt_pago.pag_fecha = '2016/10/29' ) AND  
//         ( public.plt_pago.caj_caja = 3 )   
//and pag_estado = 'activo'
//ORDER BY public.plt_pago.pag_dcmto ASC  ;

//  SELECT *
//    FROM public.plt_planilla  
//   WHERE ( public.plt_planilla.emp_empresa = 1 ) AND  
//         ( public.plt_planilla.caj_caja = 3 ) AND  
//         ( public.plt_planilla.pla_fecha = '2016/10/29' )   
//ORDER BY public.plt_planilla.pla_planilla ASC  ;

//planilla 2027

//  SELECT *
//    FROM public.plt_detplanilla  
//   WHERE ( public.plt_detplanilla.emp_empresa = 1 ) AND  
//         ( public.plt_detplanilla.caj_caja = 3 ) AND  
//         ( public.plt_detplanilla.pla_planilla = 2027 )   ;

//  SELECT *
//    FROM public.plt_detcptopla  
//   WHERE ( public.plt_detcptopla.emp_empresa = 1 ) AND  
//         ( public.plt_detcptopla.pla_planilla = 2027 ) AND  
//         ( public.plt_detcptopla.caj_caja = 3 )   ;

//  SELECT *
//    FROM public.plt_cierrecaja  
//   WHERE ( public.plt_cierrecaja.emp_empresa = 1 ) AND  
//         ( public.plt_cierrecaja.caj_caja = 3 ) AND  
//         ( public.plt_cierrecaja.cca_fecha = '2016/10/29' )   ;

//  SELECT *
//    FROM public.plt_detcierrecaj  
//   WHERE ( public.plt_detcierrecaj.emp_empresa = 1 ) AND  
//         ( public.plt_detcierrecaj.caj_caja = 3 ) AND  
//         ( public.plt_detcierrecaj.dcc_fcaja = '2016/10/29' )   ;


//////////////////////////////SE SACA EL VALOR TOTAL POR CADA MEDIO DE PAGO
//  SELECT mdp_mediopago, sum(pag_valor)
//    FROM public.plt_pago  
//   WHERE ( public.plt_pago.emp_empresa = 1 ) AND  
//         ( public.plt_pago.pag_fecha = '2016/10/29' ) AND  
//         ( public.plt_pago.caj_caja = 3 )   
//and pag_estado = 'activo'
//group by 1  ;

//1	      1946450.00
//2 	3446129.00
//5 	11000.00


///////////////////////// SE INSERTA UN REGISTRO EN PLT_CIERRECAJA POR CADA MEDIO DE PAGO CON SU RESPECTIVO VALOR

//INSERT INTO plt_cierrecaja(
//            caj_caja, emp_empresa, mdp_mediopago, cca_fecha, cca_valor, cca_estado, 
//            cca_nrocierre, cca_fcaja, pla_planilla)
//    VALUES (3, 1, 1, '2016/10/29', 1946450, 'activo', 
//            2, '2016/10/29', 2027);

//INSERT INTO plt_cierrecaja(
//            caj_caja, emp_empresa, mdp_mediopago, cca_fecha, cca_valor, cca_estado, 
//            cca_nrocierre, cca_fcaja, pla_planilla)
//    VALUES (3, 1, 2, '2016/10/29',  3446129, 'activo',
//            2, '2016/10/29', 2027);

//INSERT INTO plt_cierrecaja(
//            caj_caja, emp_empresa, mdp_mediopago, cca_fecha, cca_valor, cca_estado, 
//            cca_nrocierre, cca_fcaja, pla_planilla)
//    VALUES (3, 1, 5, '2016/10/29', 11000, 'activo', 
//            2, '2016/10/29', 2027);


////////////////////////////////////////////////////////////////////////////////////////777777
pltelas2000...*
plasti2015...*

service smb status
service postgresql-9.2 status


////////////////////////VERIFICACION DE USUARIOS//////////////7
SELECT 
usu_usuario AS  USUARIO,
usu_inventario AS MOVIMIENTOS_DE_INVENTARIO,	
//usu_cartera AS MODULO_DE_CARTERA,	
usu_recibo AS RECIBO_DE_CARTERA,	
//usu_proveedor AS MODULO_PROVEEDOR,	
usu_infclientes AS LISTADO_DE_CLIENTES,	
usu_inffactura AS INFORME_DE_FACTURACION,	
usu_infrecibo AS INFORME_DE_RECIBOS_CARTERA,	
usu_planos AS CARGA_PLANOS,	
usu_maecte AS MAESTRO_DE_CLIENTES,	
usu_maeemple AS MAESTRO_DE_EMPLEADOS,	
usu_maeprov AS MAESTRO_DE_PROVEEDORES,	
usu_maeref AS MAESTRO_DE_REFERENCIAS,	
usu_maeven AS MAESTRO_DE_VENDEDORES,	
usu_notacar AS NOTAS_DE_CARTERA,	
usu_planilla AS PLANILLAS_DE_CAJA,	
usu_comprasprov AS COMPRAS_PROVEEDOR,	
usu_reciboprov AS RECIBOS_PROVEEDOR,	
usu_notasprov AS NOTAS_PROVEEDOR,	
usu_infcaja AS INFORMES_DE_CAJA,	
usu_infprov AS INFORMES_DE_PROVEEDOR,	
usu_infcartera AS INFORME_DE_CARTERA,	
usu_infinv AS INFORME_DE_INVENTARIO,	
usu_vale AS INGRESO_DE_VALES,	
usu_pedido AS INGRESO_DE_PEDIDOS,	
usu_domicilio AS CONTROL_DE_VALES,	
usu_precioventa AS CAMBIO_PRECIO_DE_VENTA,	
usu_repmediopago AS INFORME_MEDIOS_DE_PAGO,	
usu_repvtaporvend AS INFORME_DE_VENTAS,	
usu_reptrasladosbanco as INFORME_TRASLADOS_DE_CAJA_A_BANCO																													
FROM plt_usuario  
   WHERE usu_estado = 'activo'   
AND usu_usuario <> 'amontoya'
ORDER BY usu_usuario ASC  ;
   
   
 
CREATE TABLE plt_inventariofis_par
(
  emp_empresa integer NOT NULL,
  ivf_inventario integer NOT NULL,
  ivf_fecha date NOT NULL,
  ivf_estado character varying(1) NOT NULL,
  CONSTRAINT plt_inventariofis_par_pkey PRIMARY KEY (emp_empresa, ivf_inventario)
)
WITH (
  OIDS=FALSE
);
ALTER TABLE plt_inventariofis_par
  OWNER TO postgres;
  
CREATE TABLE plt_invplanilla_par
(
  emp_empresa integer NOT NULL,
  ivf_inventario integer NOT NULL,
  ivp_planilla character varying(20) NOT NULL,
  ivp_responsable character varying(60) NOT NULL,
  ivp_fecha date NOT NULL,
  ivp_estado character varying(1) NOT NULL,
  CONSTRAINT plt_invplanilla_par_pkey PRIMARY KEY (emp_empresa, ivf_inventario, ivp_planilla)
)
WITH (
  OIDS=FALSE
);
ALTER TABLE plt_invplanilla_par
  OWNER TO postgres;
  
  
CREATE TABLE plt_invdetplanilla_par
(
  emp_empresa integer NOT NULL,
  ivf_inventario integer NOT NULL,
  ivp_planilla character varying(20) NOT NULL,
  ivd_secuencia integer NOT NULL,
  ref_referencia character varying(6) NOT NULL,
  ref_diseno character varying(15) NOT NULL,
  ref_color character varying(15) NOT NULL,
  ivd_ubicacion character varying(20) NOT NULL,
  ivd_cantidadfis numeric(14,2) NOT NULL,
  ivd_fecha date NOT NULL,
  ivd_estado character varying(1) NOT NULL,
  CONSTRAINT plt_invdetplanilla_par_pkey PRIMARY KEY (emp_empresa, ivf_inventario, ivp_planilla, ivd_secuencia),
  CONSTRAINT plt_invdetplanilla_par_fk FOREIGN KEY (emp_empresa, ivf_inventario, ivp_planilla)
      REFERENCES plt_invplanilla_par (emp_empresa, ivf_inventario, ivp_planilla) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
)
WITH (
  OIDS=FALSE
);
ALTER TABLE plt_invdetplanilla_par
  OWNER TO postgres;

  
  
CREATE TABLE plt_inventariofin_par
(
  emp_empresa integer NOT NULL,
  ivf_inventario integer NOT NULL,
  ref_referencia character varying(6) NOT NULL,
  ref_diseno character varying(15) NOT NULL,
  ref_color character varying(15) NOT NULL,
  ivn_cantidadfis numeric(14,2) NOT NULL,
  ivn_cantidadteo numeric(14,2) NOT NULL,
  ivn_diferencia numeric(14,2) NOT NULL,
  ivn_costo numeric(14,2) NOT NULL,
  ivn_fecha date NOT NULL,
  ivn_estado character varying(1) NOT NULL,
  CONSTRAINT plt_inventariofin_par_pkey PRIMARY KEY (emp_empresa, ivf_inventario, ref_referencia, ref_diseno, ref_color),
  CONSTRAINT plt_inventariofin_par_fk FOREIGN KEY (emp_empresa, ivf_inventario)
      REFERENCES plt_inventariofis_par (emp_empresa, ivf_inventario) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
)
WITH (
  OIDS=FALSE
);
ALTER TABLE plt_inventariofin_par
  OWNER TO postgres;
  
  
  
   CREATE TABLE plt_referencia_invpar
(
  ref_referencia character varying(6) NOT NULL DEFAULT NULL::character varying,
  ref_nombre character varying(50) NOT NULL DEFAULT NULL::character varying,
  ref_cantidad numeric(8,2) DEFAULT NULL::numeric,
  ref_estado character varying(15) NOT NULL DEFAULT NULL::character varying,
  ref_diseno character varying(15) NOT NULL DEFAULT NULL::character varying,
  ref_color character varying(15) NOT NULL DEFAULT NULL::character varying,
  CONSTRAINT plt_referencia_invpar_pkey PRIMARY KEY (ref_referencia, ref_diseno, ref_color)
)
WITH (
  OIDS=FALSE
);
ALTER TABLE plt_referencia_invpar
  OWNER TO postgres;
  
  
  f_det_inventariofis_par
  f_finaliza_inventariofin_par

  
  
  // update sai_actualizapc  set apc_actualiza = 'N' 
//   WHERE apc_actualiza = 'S'   ;

//  SELECT *
//    FROM public.plt_cliente  
//   WHERE public.plt_cliente.cli_nombre like '%CREATIVOS%'   ;

//SELECT 	plt_movinv.ref_referencia,   
//				plt_referencia.ref_nombre,   
//				plt_movinv.min_diseno,   
//				plt_movinv.min_color,   
//		        plt_movinv.min_cantidad,   
//		        plt_movinv.min_costo,   
//		        plt_referencia.ref_costo,   
//		        plt_movinv.min_vlrvta,   
//		        plt_movinv.min_fecha,   
//		        plt_movinv.min_dcmto,   
//		        plt_cliente.cli_ccnit,   
//		        plt_cliente.cli_nombre,
//				Cast('' as character varying(1)) as tipocosto,
//				Cast((
//					SELECT 	SUM(ref_cantidad)
//					FROM 	plt_referencia  
//					WHERE 	( plt_referencia.ref_referencia = plt_movinv.ref_referencia) AND  
//							( plt_referencia.ref_diseno = plt_movinv.min_diseno ) AND  
//							( plt_referencia.ref_color = plt_movinv.min_color ) 
//				) as numeric(14,2))as cantidadact
//	    FROM 	plt_movinv,   
//				plt_referencia,   
//				plt_movcar,   
//				plt_cliente  
//	   WHERE 	( plt_movinv.ref_referencia = plt_referencia.ref_referencia ) and  
//				( plt_movinv.min_diseno = plt_referencia.ref_diseno ) and  
//				( plt_movinv.min_color = plt_referencia.ref_color ) and  
//				( plt_movinv.emp_empresa = plt_movcar.emp_empresa ) and  
//				( plt_movinv.tdc_dcmto = plt_movcar.tdc_dcmto ) and  
//				( plt_movinv.min_dcmto = plt_movcar.mca_dcmto ) and  
//				( plt_movinv.caj_caja = plt_movcar.caj_caja ) and  
//				( plt_movinv.cca_nrocierre = plt_movcar.cca_nrocierre ) and  
//				( plt_movinv.min_fcaja = plt_movcar.mca_fcaja ) and  
//				( plt_movcar.cli_ccnit = plt_cliente.cli_ccnit ) and  
//				( ( plt_movinv.emp_empresa = 3 ) AND  
//				//( plt_movinv.ref_referencia = $1 OR $1 = '-1' ) AND  
//				( plt_movinv.min_fecha >= '2017/01/01' ) AND  
//				( plt_movinv.min_fecha <= '2017/03/31' ) AND  
//				( plt_movinv.cpi_concepto = 51 ) AND  
//				( plt_movinv.min_estado = 'activo' ) AND 
//				( plt_movcar.cli_ccnit =  '900754665-8' ) //AND
//				//( plt_movinv.min_diseno = $7 OR $7 = '-1' ) AND
//				//( plt_movinv.min_color = $8 OR $8 = '-1' ) 
//)   
//		ORDER BY plt_movinv.min_fecha ASC 
//;


//  SELECT *
//    FROM public.plt_movcar  
//   WHERE public.plt_movcar.cli_ccnit =    '900754665-8'   
//and				( plt_movcar.mca_fecha >= '2017/01/01' )   
//and				( plt_movcar.mca_fecha <= '2017/03/31' )   ;

select * from plt_movinv
where min_dcmto = '120463'
and tdc_dcmto = 1
and emp_empresa = 3
and min_fecha = '2017/02/07';



//SELECT 	((SUM(plt_movinv.min_vlrvta) - SUM(plt_movinv.min_costo) )/SUM(plt_movinv.min_vlrvta)) * 100
//        FROM 	plt_movinv,   
//				plt_referencia,   
//				plt_movcar,   
//				plt_cliente  
//	   WHERE 	( plt_movinv.ref_referencia = plt_referencia.ref_referencia ) and  
//				( plt_movinv.min_diseno = plt_referencia.ref_diseno ) and  
//				( plt_movinv.min_color = plt_referencia.ref_color ) and  
//				( plt_movinv.emp_empresa = plt_movcar.emp_empresa ) and  
//				( plt_movinv.tdc_dcmto = plt_movcar.tdc_dcmto ) and  
//				( plt_movinv.min_dcmto = plt_movcar.mca_dcmto ) and  
//				( plt_movinv.caj_caja = plt_movcar.caj_caja ) and  
//				( plt_movinv.cca_nrocierre = plt_movcar.cca_nrocierre ) and  
//				( plt_movinv.min_fcaja = plt_movcar.mca_fcaja ) and  
//				( plt_movcar.cli_ccnit = plt_cliente.cli_ccnit ) and  
//				( ( plt_movinv.emp_empresa = 1 ) AND  
//				( plt_movinv.min_fecha >= '2017/03/01' ) AND  
//				( plt_movinv.min_fecha <=  '2017/03/31' ) AND  
//				( plt_movinv.cpi_concepto = 51 ) AND  
//				( plt_movinv.min_estado = 'activo' ) AND 
//				( plt_movcar.cli_ccnit = '900593431-1' ) )  ;



////////////////////////////////////////NOTAS A PROVEEDOR////////////////////
Compras a proveedores
14350105    inventari0  db
24080217   iva          db
23654001              cr
22050501              cr

Notas a proveedores
14350105    inventari0  cr
24080106   iva          cr
23654001              db
22050501              db
////////////////////////////////////////FIN DE NOTAS A PROVEEDOR/////////////


Cajeros recibos caja
100
	pago con 110
	
	El cajero debe digitar lo que no devolvió realmente
	la diferencia(Devuelta menos los que digitó) es la que hay que contabilizar
	Contabilizar lo que el cajero no devolvió
	Asiento contable
	11xxx 
	1305
	4500  
	
Revisar control de devuelta en caja
Quitar opcion de anular facturas--- en plastitelas 2

	
	
	
	//    SELECT *
//    FROM public.plt_compraprov  
//    WHERE ( public.plt_compraprov.com_fecha = '2017/07/26' ) AND  
//         ( public.plt_compraprov.com_compra = '20170726' )   
//   ORDER BY public.plt_compraprov.pro_proveedor ASC  ;

//    SELECT *
//    FROM public.plt_saldoprov  
//    WHERE ( public.plt_saldoprov.slp_fechaini = '2017/07/26' ) AND  
//         ( public.plt_saldoprov.slp_dcmto = '20170726' )   
//    ORDER BY public.plt_saldoprov.pro_proveedor ASC  ;



//update sai_actualizapc set apc_actualiza = 'N' 
//			where apc_actualiza = 'S' ;

//  SELECT *
////    FROM public.plt_factura  
//   WHERE ( public.plt_factura.emp_empresa = 3 ) AND  
//         ( public.plt_factura.cli_ccnit = '1015067038' )  
//and tdc_tipodoc = 11
//order by fac_fecha ;

//  SELECT *
//    FROM public.plt_movcar  
//   WHERE ( public.plt_movcar.mca_dcmto = 2713 ) AND  
//         ( public.plt_movcar.emp_empresa = 3 )   ;

  SELECT *
    FROM public.plt_pago  
   WHERE ( public.plt_pago.emp_empresa = 3 )   
   //      ( public.plt_pago.pag_dcmto = 1910 ) 
and cli_ccnit = '1214730105'   
and 
order by pag_fecha  ;


//SELECT *
//    FROM public.plt_saldo  
//   WHERE ( public.plt_saldo.emp_empresa = 3 ) AND  
//         ( public.plt_saldo.sld_dcmto in ('362', '151') ) AND  
//         ( public.plt_saldo.cli_ccnit = '8248517-0' )   ;

//   update plt_pago  set rec_recibo = null
//   WHERE ( public.plt_pago.emp_empresa = 3 ) AND  
//         ( public.plt_pago.pag_dcmto = 2270 ) 
//and cli_ccnit = '8248517-0'     ;

	
//	    SELECT *
//    FROM public.plt_compraprov  
//    WHERE ( public.plt_compraprov.com_fecha = '2017/10/07' ) AND  
//         ( public.plt_compraprov.com_compra = '20171007' )   
//   ORDER BY public.plt_compraprov.pro_proveedor ASC  ;

//    SELECT *
//    FROM public.plt_saldoprov  
//    WHERE ( public.plt_saldoprov.slp_fechaini = '2017/10/07' ) AND  
//         ( public.plt_saldoprov.slp_dcmto = '20171007' )   
//    ORDER BY public.plt_saldoprov.pro_proveedor ASC  ;


//update sai_actu	
//	    SELECT *
//    FROM public.plt_compraprov  
//    WHERE ( public.plt_compraprov.com_fecha = '2017/10/07' ) AND  
//         ( public.plt_compraprov.com_compra = '20171007' )   
//   ORDER BY public.plt_compraprov.pro_proveedor ASC  ;

//    SELECT *
//    FROM public.plt_saldoprov  
//    WHERE ( public.plt_saldoprov.slp_fechaini = '2017/10/07' ) AND  
//         ( public.plt_saldoprov.slp_dcmto = '20171007' )   
//    ORDER BY public.plt_saldoprov.pro_proveedor ASC  ;


//update sai_actualizapc set apc_actualiza = 'N' 
//			where apc_actualiza = 'S' ;alizapc set apc_actualiza = 'N' 
//			where apc_actualiza = 'S' ;
  
	
//	    SELECT *
//    FROM public.plt_compraprov  
//    WHERE ( public.plt_compraprov.com_fecha = '2017/10/07' ) AND  
//         ( public.plt_compraprov.com_compra = '20171007' )   
//   ORDER BY public.plt_compraprov.pro_proveedor ASC  ;

//    SELECT *
//    FROM public.plt_saldoprov  
//    WHERE ( public.plt_saldoprov.slp_fechaini = '2017/10/07' ) AND  
//         ( public.plt_saldoprov.slp_dcmto = '20171007' )   
//    ORDER BY public.plt_saldoprov.pro_proveedor ASC  ;


//update sai_actualizapc set apc_actualiza = 'N' 
//			where apc_actualiza = 'S' ;





